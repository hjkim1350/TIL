## 2022.09.28 Django05



#### ğŸ“ŒNamespace

---

- ë™ì¼í•œ í”„ë¡œì íŠ¸ ë‚´ ë‹¤ë¥¸ appì—ì„œ ê°™ì€ URLì„ ì‚¬ìš©í•˜ë©´ ì´ë¦„ ì¶©ëŒì´ ë‚˜ê²Œ ë¨.

- ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•œ ë°©ë²•ì€ ì´ 2ê°€ì§€ì„.

- **í•´ê²°ë°©ë²•1)** URL tagë¥¼ í•˜ê¸°ì™€ ê°™ì´ ë³€ê²½í•˜ì—¬ Namespaceë¥¼ ì§€ì •í•´ì¤Œ

  ```python
  {% url 'index' %} --> {% url 'articles:index' %}
  ```

  

- **í•´ê²°ë°©ë²•2)** ë””ë ‰í† ë¦¬ êµ¬ì¡°ë¥¼ app_name/templates/app_name í˜•íƒœë¡œ ë³€ê²½í•˜ì—¬ ë¬¼ë¦¬ì  ê³µê°„ ë¶„ë¦¬



#### ğŸ“ŒNaming URL patterns

---

- ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ ë‚´ì— ë§ì€ í˜ì´ì§€ë¡œ êµ¬ì„±ë˜ì–´ ìˆëŠ”ë° index/ ë¬¸ìì—´ ì£¼ì†Œë¥¼ new-index/ë¡œ ë³€ê²½í•´ì•¼ í•œë‹¤ë©´,
  ìˆ˜ ë§ì€ í˜ì´ì§€ì— ì ìš©ë˜ì–´ ìˆëŠ” index/ ë¼ëŠ” ë¬¸ìì—´ì„ ì°¾ì•„ ëª¨ë‘ ë°”ê¿”ì¤˜ì•¼í•˜ëŠ” ìˆ˜ê³ ë¡œì›€ì´ ìƒê¹€.

- ë”°ë¼ì„œ, urls.pyì˜ path() í•¨ìˆ˜ì— ì†ì„± nameì„ ì§€ì •í•˜ì—¬ì•¼ í•¨

  ```python
  # urls.py
  urlpatterns = [
      path('index/', views.index, name='index')
  ]
  ```



#### ğŸ“ŒModel

---

- DjangoëŠ” Modelì„ í†µí•´ ë°ì´í„°ì— ì ‘ê·¼í•˜ê³  ì¡°ì‘í•¨
- ì¼ë°˜ì ìœ¼ë¡œ ëª¨ë¸ í´ë˜ìŠ¤ 1ê°œëŠ” 1ê°œì˜ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì— ë§¤í•‘ë¨



#### âœï¸ê°€ìƒí™˜ê²½ ì„¤ì¹˜ë¶€í„° CRD êµ¬í˜„ê¹Œì§€(UpdateëŠ” ë‚´ì¼ êµ¬í˜„ ì˜ˆì •) Manual

---

1) ê°€ìƒí™˜ê²½ ìƒì„±

   ```python
   # ìœ„ì¹˜: server_day4
   $ python -m venv server-venv
   ```

   

2) ê°€ìƒí™˜ê²½ ì‹¤í–‰

   ```python
   # ìœ„ì¹˜: server_day4
   $ . server-venv/Scripts/activate
   
   # ì‹¤í–‰í•˜ë©´ í•˜ê¸°ì™€ ê°™ì´ ì»¤ë§¨ë“œë¼ì¸ ìœ„ (ê°€ìƒí™˜ê²½)ìœ¼ë¡œ ë¬¸ìì—´ ì¶œë ¥ë¨
   (server-venv)
   $
   ```

   

3) Django ì„¤ì¹˜

   ```python
   # ìœ„ì¹˜: server_day4
   (server-venv)
   $ pip install django=3.2.13
   
   # pip listë¡œ Django ì„¤ì¹˜ ë‚´ì—­ í™•ì¸
   (server-venv)
   $ pip list
   
   Package    Version
   ---------- --------
   asgiref    3.5.2
   Django     3.2.13
   pip        22.0.4
   pytz       2022.2.1
   setuptools 58.1.0
   sqlparse   0.4.3
   ```

   

4) í”„ë¡œì íŠ¸ ìƒì„±

   ```python
   # ìœ„ì¹˜: server_day4
   (server-venv)
   $ django-admin startproject todo .
   ```

   

5) App ìƒì„±

   ```python
   # ìœ„ì¹˜: server_day4
   (server-venv)
   $ django-admin startapp todoapp
   ```

   

6) ì„œë²„ êµ¬ë™ í…ŒìŠ¤íŠ¸

   ```python
   # ìœ„ì¹˜: server_day4
   (server-venv)
   $ python manage.py runserver
   
   # ì›¹ë¸Œë¼ìš°ì €ì—ì„œ localhost:8000/ ì…ë ¥í•˜ì—¬ django ì´ˆê¸° í˜ì´ì§€ê°€ ì¶œë ¥ë˜ë©´ ì„±ê³µ
   
   # python manage.py runserver ëª…ë ¹ì–´ê°€ ë„ˆë¬´ ê¸¸ë©´ shortcuts í™œìš©
   # shortcuts ì„¤ì •ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŒ
   # 1) íŒ¨í‚¤ì§€ ì„¤ì¹˜
   (server-venv)
   $ pip install django-shortcuts
   
   # 2) django [shortcuts] ì¹˜ë©´ ë°”ë¡œ êµ¬ë™ë¨
   # shortcutsì˜ ë‹¤ë¥¸ ë‹¨ì¶•ëª…ë ¹ì–´ë¥¼ ë³´ë ¤ë©´ https://pypi.org/project/django-shortcuts/ í™•ì¸
   # í•˜ê¸° ëª…ë ¹ì–´ëŠ” python manage.py runserverì˜ ë‹¨ì¶• ëª…ë ¹ì–´ì„
   (server-venv)
   $ django r
   
   # ì°¸ê³ ) startappì„ í•˜ê³  ì‹¶ìœ¼ë©´ í•˜ê¸°ì™€ ê°™ì´ ëª…ë ¹ì–´ ì‹¤í–‰
   (server-venv)
   $ django sa
   ```

   

7) ìƒì„±í•œ APP ë“±ë¡

   ```python
   # ìœ„ì¹˜: server_day4\todo\settings.py
   
   INSTALLED_APPS = [
       'todoapp',
       'django.contrib.admin',
       .....
   ]
   ```

   

8) ëª¨ë¸ ìƒì„±: ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì˜ ìŠ¤í‚¤ë§ˆ ì •ì˜

   ìƒì„±í•´ì•¼ í•  ëª¨ë¸ í•„ë“œ ë° ì†ì„±ì€ ë‹¤ìŒê³¼ ê°™ìŒ

   | í•„ë“œ ì´ë¦„  | ì—­í•        | í•„ë“œ    | ì†ì„±              |
   | ---------- | ---------- | ------- | ----------------- |
   | content    | í•  ì¼ ë‚´ìš© | Char    | max_lenght=80     |
   | completed  | ì™„ë£Œ ì—¬ë¶€  | Boolean | default=False     |
   | priority   | ìš°ì„ ìˆœìœ„   | Integer | default=3         |
   | created_at | ìƒì„± ë‚ ì§œ  | Date    | auto_now_add=True |
   | deadline   | ë§ˆê° ê¸°í•œ  | Date    | null=True         |

   

   ```python
   # ìœ„ì¹˜: server_day4\todoapp\models.py
   from django.db import models
   
   # Create your models here.
   # ì•„ê·œë¨¼íŠ¸ models.Modelì€ importí•œ models ëª¨ë“ˆì˜ Modelì„ ìƒì†ë°›ì•„ êµ¬ì„±ë¨
   class todoapp(models.Model):
       
       # DB ì •ì˜
       # í•„ë“œ = models.ì–´ë–¤ íƒ€ì…ì˜ í•„ë“œì¸ì§€(ê¸°ë³¸ê°’)
       # ê¸°ë³¸ê°’ì„ ì„¤ì •í•˜ì§€ ì•Šì„ ê²½ìš° djangoì—ì„œ ìë™ìœ¼ë¡œ ê°’ì„ ì„¤ì •í•¨
       content = models.CharField(max_length=80)
       completed = models.BooleanField(default=False)
       priority = models.IntegerField(default=3)
       created_at = models.DateField(auto_now_add=True)
       deadline = models.DateField(null=True)
   ```

   

9) DB migration ìƒì„± (migration: í•œ ìš´ì˜í™˜ê²½ìœ¼ë¡œë¶€í„° ë‹¤ë¥¸ ìš´ì˜í™˜ê²½ìœ¼ë¡œ ì˜®ê¸°ëŠ” ì‘ì—…)

   - migration ì‘ì—… í›„ server_day4\todoapp\migrations\0001_initial.py ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸
   - íŒŒì´ì¬ìœ¼ë¡œ ì‘ì„±ëœ DB ì„¤ê³„ë„ê°€ ìƒì„±ë˜ì—ˆìŒ!

   ```python
   # ìœ„ì¹˜: server_day4
   (server-venv)
   $ python manage.py makemigrations
   
   # ë˜ëŠ” shortcutsë¥¼ ì´ìš©
   (server-venv)
   $ django mm
   
   Migrations for 'todoapp':
     todoapp\migrations\0001_initial.py
       - Create model todoapp
   (server-venv) 
   ```

   

10) migrate ì‘ì—… ìˆ˜í–‰

    - 9ë²ˆì—ì„œ ìƒì„±í•œ ì„¤ê³„ë„ë¥¼ ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•˜ëŠ” ê³¼ì •
    - í•´ë‹¹ ì‘ì—…ì„ ê±°ì¹˜ë©´ db.sqlite3 íŒŒì¼ì— ë°˜ì˜ë¨

    ```python
    # ìœ„ì¹˜: server_day4
    (server-venv)
    $ python manage.py migrate
    
    # ë˜ëŠ” shortcutsë¥¼ ì´ìš©
    (server-venv)
    $ django m
    
    ....
    Applying sessions.0001_initial... OK
    Applying todoapp.0001_initial... OK
    ....
    ```

    

11) todoappì˜ templates ì •ì˜ ë° index í˜ì´ì§€ ìƒì„±

    ```html
    # ìœ„ì¹˜: server_day4\todoapp
    # 1) í´ë” templates ìƒì„±í•˜ê³ , ìƒì„±í•œ templates í´ë” í•˜ìœ„ì— ë‹¤ì‹œ todoapp í´ë” ìƒì„±
    # 2) server_day4\todoapp\templates\todoapp ë‚´ì— index.html ìƒì„±
    
    # server_day4\todoapp\templates\todoapp\index.html
    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
    </head>
    
    <body>
      <h1>todoapp index í˜ì´ì§€ í…ŒìŠ¤íŠ¸</h1>
    </body>
    
    </html>
    ```

    

12) ë‹¤ì¤‘ app ì‹¤í–‰ì„ ìœ„í•´ URL ë¶„ë¦¬: todoappì˜ urls.py ìƒì„±

    ```python
    # ìœ„ì¹˜: server_day4\todoapp\urls.py
    
    # urls íŒ¨í‚¤ì§€ ë‚´ì˜ path ëª¨ë“ˆ ê°€ì ¸ì˜´
    from django.urls import path
    # í˜„ì¬ ë””ë ‰í† ë¦¬ì—ì„œ views ëª¨ë“ˆ ê°€ì ¸ì˜´
    from . import views
    
    # ë£¨íŠ¸ í˜ì´ì§€ URL ë“±ë¡
    urlpatterns = [
        path("", views.index, name="index"),
    ]
    ```

    

13) todo í”„ë¡œì íŠ¸ì— ìƒì„±í•œ todoappì˜ urls.py ì¸ì‹í•˜ë„ë¡ ì„¤ì •

    ```python
    # ìœ„ì¹˜: server_day4\todo\urls.py
    from django.contrib import admin
    from django.urls import path, include # ìˆ˜ì •: include ì¶”ê°€
    
    urlpatterns = [
        path("admin/", admin.site.urls),
        path("", include("todoapp.urls")),
    ]
    ```

    

14) ìƒì„±í•œ index.htmlì´ ë£¨íŠ¸ í˜ì´ì§€ë¡œ ì œëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸

    ```python
    # ìœ„ì¹˜: server_day4
    (server-venv)
    $ django r
    
    # ì›¹ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ì— localhost:8000 ì…ë ¥í•˜ì—¬ ìƒì„±í–ˆë˜ index.html ë‚´ìš©ì´ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸
    ```

    

15) ì¬ì‚¬ìš©ì„±ì„ ìœ„í•œ base.html ìƒì„±

    ```html
    # ìœ„ì¹˜: server_day4
    # templates í´ë” ìƒì„±, server_day4\templates\ ì— base.html ìƒì„±
    
    # ìµœì¢… ìœ„ì¹˜: server_day4\base.html
    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <!-- CSS Bootstrap -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    </head>
    
    <body>
      <!-- JS Bootstrap -->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous">
        </script>
    
      {% block content %}
      {% endblock %}
    </body>
    
    </html>
    ```

    

16) base.html ì¸ì‹ì„ ìœ„í•œ BASE_DIR ì„¤ì •

    ```python
    # ìœ„ì¹˜: server_day4\todo\settings.py
    ...
    # í•˜ê¸° ê²½ë¡œëŠ” ìˆ˜ì •í•˜ì§€ ì•ŠìŒ, djangoì—ì„œ ì„¤ì •í•œ ê¸°ë³¸ê°’ ê·¸ëŒ€ë¡œ ê°€ì ¸ê°
    # í•˜ê¸° ê²½ë¡œëŠ” í”„ë¡œì íŠ¸ì˜ ìµœìƒë‹¨ í´ë”ë¥¼ ê°€ë¦¬í‚¨ë‹¤ê³  ì´í•´í•˜ê³  ë„˜ì–´ê°
    BASE_DIR = Path(__file__).resolve().parent.parent
    ...
    
    # "DIRS":[] -> "DIRS":[BASE_DIR / "templates"],ìœ¼ë¡œ ìˆ˜ì •
    TEMPLATES = [
        {
            "BACKEND": "django.template.backends.django.DjangoTemplates",
            "DIRS": [BASE_DIR / "templates"], # [] -> [BASE_DIR / "templates"],ìœ¼ë¡œ ìˆ˜ì •
            "APP_DIRS": True,
            "OPTIONS": {
                "context_processors": [
                    "django.template.context_processors.debug",
                    "django.template.context_processors.request",
                    "django.contrib.auth.context_processors.auth",
                    "django.contrib.messages.context_processors.messages",
                ],
            },
        },
    ]
    ```

    

17) index.htmlì— base.html í™•ì¥í•˜ì—¬ base.html ê°’ì„ ê°€ì ¸ì˜¤ë„ë¡ ì„¤ì •

    ```html
    # ìœ„ì¹˜: server_day4\todoapp\index.html
    
    {% extends 'base.html' %}
    {% block content %}
    
    <h1>todoapp index í˜ì´ì§€ í…ŒìŠ¤íŠ¸</h1>
    {% endblock %}
    ```

    

18) ì •ìƒ êµ¬ë™ë˜ëŠ”ì§€ í™•ì¸

    ```python
    # ìœ„ì¹˜: server_day4
    (server-venv)
    $ django r
    
    # ì›¹ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ì— localhost:8000 ì…ë ¥í•˜ì—¬ ìƒì„±í–ˆë˜ index.html ë‚´ìš©ì´ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸
    ```

    

19) asdf
